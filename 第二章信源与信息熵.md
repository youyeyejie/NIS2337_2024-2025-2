# 第二章 信源与信息熵

## 2.1 信源的分类及数学模型
![信源分类](image/image-1.png)

### 无记忆的单符号
- **离散**
    - 信源输出单个符号的消息，出现的消息数是有限的，且只可能是符号集中的一种
    - 各符号出现的概率与信源相互确定
    - **数学表示**：
        \[
        \begin{bmatrix} X \\ P \end{bmatrix} = 
        \begin{bmatrix} a_1 & a_2 & \cdots & a_n \\ p(a_1) & p(a_2) & \cdots & p(a_n) \end{bmatrix}
        \]

        其中符号集 \(A = \{a_1, a_2, \cdots, a_n\}\)，\(X \in A\)。显然有 \(p(a_i) \geq 0\)，\(\sum_{i = 1}^{n} p(a_i) = 1\)。 
- **连续**
    - 信源输出单个符号的消息，出现的消息数是无限的
    - **数学表示**：
        \[
        \begin{bmatrix} X \\ P \end{bmatrix} = 
        \begin{bmatrix} (a,b) \\ p_X(x) \end{bmatrix}
        或
        \begin{bmatrix} R \\p_X(x) \end{bmatrix}
        \]

        显然应满足 \(p_X(x) \geq 0\)，\(\int_{a}^{b} p_X(x) \mathrm{d}x = 1\) 或 \(\int_{R} p_X(x) \mathrm{d}x = 1\)。

### 无记忆的符号序列
- 每次发出一组含2个以上符号的符号序列来代表一个消息
- 需要用随机序列（或随机矢量）\(\mathbf{X}=(X_1,X_2,\cdots,X_l,\cdots,X_L)\)来描述信源输出的消息，用联合概率分布来表示信源特性。
- 最简单的符号序列信源是\(L\)为2的情况，此时信源\(\mathbf{X}=(X_1,X_2)\)，其信源的概率空间为：
    \[
    \begin{bmatrix} \mathbf{X} \\ P \end{bmatrix} = 
    \begin{bmatrix} a_1,a_1 & a_1,a_2 & \cdots & a_n,a_n \\ p(a_1,a_1) & p(a_1,a_2) & \cdots & p(a_n,a_n) \end{bmatrix} \quad 
    \]

    显然有 \(p(a_i,a_j)\geq0\)，\(\sum_{i,j = 1}^{n} p(a_i,a_j) = 1\)。 

- ***无记忆***
    - 符号序列的各维相独立（**有放回取球**）
    - \(p(X_1,X_2,\cdots,X_l,\cdots,X_L) = p(X_1)p(X_2)\cdots p(X_l)\cdots p(X_L)\)

- ***平稳***
    - 信源发出的序列的统计性质与时间的推移无关，是平稳的随机序列。
    - 强：各维概率分布都不随时间推移而发生变化
    - 弱：序列均值与起始时刻无关、协方差函数也与起始时刻无关而仅与时间间隔有关
    - \(p(X_1)=p(X_2)=\cdots =p(X_l)=\cdots =p(X_L)\)
    - \(p(X_1,X_2,\cdots,X_L)=\prod_{l = 1}^{L}p(X_l)=[p(X)]^L\)

### 有记忆的符号序列
- 信源在不同时刻发出的符号之间是相互依赖的。（**不放回取球**）
    \[
    \begin{align*}
    p(x_1,x_2,x_3,\cdots,x_L)&=p(x_L\mid x_1,x_2,x_3,\cdots,x_{L - 1})p(x_1,x_2,x_3,\cdots,x_{L - 1})\\
    &=\cdots\\
    &=p(x_1)p(x_2|x_1)p(x_3|x_2,x_1)\cdots p(x_L|x_{L-1},\cdots, x_1)
    \end{align*}
    \]
- 表述的复杂度将随着序列长度的增加而增加。


### 马尔可夫信源
- **m阶马尔可夫信源**
    - 当信源的记忆长度为m十1时，该时刻发出的符号与前m个符号有关联性，而与更前面的符号无关
    - \[
    \begin{align*}
    p(x_1,x_2,x_3,\cdots,x_L)&=p(x_L\mid x_1,x_2,x_3,\cdots,x_{L - 1})p(x_1,x_2,x_3,\cdots,x_{L - 1})\\
    &=p(x_L\mid x_{L - m},\cdots,x_{L - 1})p(x_1,x_2,x_3,\cdots,x_{L - 1})\\
    &=p(x_L\mid x_{L - m},\cdots,x_{L - 1})p(x_{L - 1}\mid x_{L - m - 1},\cdots,x_{L - 2})p(x_1,x_2,x_3,\cdots,x_{L - 2})\\
    &=\cdots
    \end{align*}
    \]
    - **齐次马尔可夫信源**：条件概率与时间起点无关

- **状态$S_i$**
    - 对于 \(m\) 阶马尔可夫信源，将该时刻以前出现的 \(m\) 个符号组成的序列定义为状态 \(s_i\)
    - \(s_i=(x_{i_1},x_{i_2},\cdots,x_{i_m})\quad x_{i_1},x_{i_2},\cdots,x_{i_m}\in A=(a_1,a_2,\cdots,a_n)\)
    - \(s_i\) 共有 \(Q = n^m\) 种可能取值，即状态集 \(S = \{s_1,s_2,\cdots,s_Q\}\)
    - 则上述条件概率 \(p(x_j\mid x_{j - m},\cdots,x_{j - 1})\) 中的条件 \(x_{j - m},\cdots,x_{j - 1}\) 就可以用状态 \(s_i\) 来代表，表示信源在某一时刻出现符号 \(x_j\) 的概率与信源此时所处的状态 \(s_i\) 有关
    - 用符号条件概率表示为 \(p(x_j\mid s_i)\)，\(i = 1,2,\cdots,Q\)；\(j = 1,2,\cdots,n\)

- **状态转移概率**
    - 在时刻 \(m\) 系统处于状态 \(s_i\)（即 \(S_m=s_i\)）的条件下，经 \(n - m\) 步后转移到状态 \(s_j\) （即 \(S_n=sj\)）的概率用状态转移概率 \(p_{ij}(m,n)\) 表示：
    - \[
    p_{ij}(m,n)=P\{S_n = s_j\mid S_m = s_i\}=P\{s_j\mid s_i\}\quad s_i,s_j\in S
    \]
    - 性质：
        1. \(p_{ij}(m,n)\geq0\)，\(i,j\in S\)
        2. \(\sum_{j\in S}p_{ij}(m,n)=1\)，\(i\in S\)

- **一步转移概率**
    - \(n - m = 1\)时，即 \(p_{ij}(t,t + 1)\),记为 \(p_{ij}(t)\)，\(t\geq0\)，并称为基本转移概率，也可称为一步转移概率。
    - \[
    p_{ij}(t)=p_{ij}(t,t + 1)=P\{S_{t + 1}=j\mid S_t = i\}\overset{齐次}{=}p_{ij}\quad i,j\in S
    \]
    - 性质：
        1. \(p_{ij}\geq0\)，\(i,j\in S\)
        2. \(\sum_{j\in S}p_{ij}=1\)，\(i\in S\)

- **k步转移概率**
    - \[
    p_{ij}^{(k)}(t)=p_{ij}(t,t + k)=P\{S_{t + k}=j\mid S_t = i\}=p_{ij}^{(k)}\quad i,j\in S
    \]
    - 切普曼 - 柯尔莫戈洛夫方程\(p_{ij}^{(k)}=\sum_{r}p_{ir}^{(l)}p_{rj}^{(k - l)}\)，特别地，当 $l = 1$ 时，有
        \[
        p_{ij}^{(k)}=\sum_{r}p_{ir}p_{rj}^{(k - 1)}=\sum_{r}p_{ir}^{k - 1}p_{rj}
        \]
    - 若用矩阵表示，则
        \[
        \mathbf{P}^{(k)}=\mathbf{P}\mathbf{P}^{(k - 1)}=\mathbf{P}\mathbf{P}\mathbf{P}^{(k - 2)}=\cdots=\mathbf{P}^{k}
        \]
    - 一步转移概率完全决定了k步转移概率，引入初始概率\(p_{0i}=P(S_{0}=s_{i})\)
        \[
        \begin{align*}
        P(S_{k}=s_{j})&=\sum_{i}P(S_{k}=s_{j},S_{0}=s_{i})\\
        &=\sum_{i}P(S_{0}=s_{i})P(S_{k}=s_{j}\mid S_{0}=s_{i})\\
        &=\sum_{i}p_{0i}p_{ij}^{(k)}
        \end{align*}
        \]

- **转移矩阵**
    - k步转移矩阵\(\mathbf{P}=\{p_{ij}^{(k)}(m),i,j\in S\}\)
    - 一步转移矩阵\(\mathbf{P}=\{p_{ij},i,j\in S\}\)
        \[
        \mathbf{P}=
        \begin{bmatrix}
        p_{11} & p_{12} & \cdots & p_{1Q} \\
        p_{21} & p_{22} & \cdots & p_{2Q} \\
        \vdots & \vdots & \ddots & \vdots \\
        p_{Q1} & p_{Q2} & \cdots & p_{QQ}
        \end{bmatrix}
        \]

- **马尔可夫链的稳定**
    - **定义**：\(\lim_{k \to \infty}p_{ij}^{(k)} = W_j\)
    - **求取**：
        \[
        \left\{
        \begin{array}{l}
        \mathbb{W}\mathbf{P}=\mathbb{W}\\
        \sum_{i}W_j = 1
        \end{array}
        \right.
        \]

        其中\(\mathbb{W}=\begin{bmatrix} W_1 & W_2 & \cdots & W_Q \end{bmatrix}\)，\(W_j = \lim_{k \to \infty}p_{ij}^{(k)}\)
    - **条件**
        - 必要不充分：上式有唯一解，则$\lim_{k \to \infty}p_{ij}^{(k)}$ 存在
        - **不可约性**
            - 对任意一对 \(i\) 和 \(j\)，都存在至少一个 \(k\)，使 \(p_{ij}^{(k)}>0\)，这就是说从 \(s_i\) 开始，总有可能到达 \(s_j\)
            - 反之若对所有 \(k\)，\(p_{ij}^{(k)} = 0\)，就意味着一旦出现 \(s_i\) 以后不可能到达 \(s_j\)，也就是不能各态遍历
                - 此时状态中把 \(s_j\) 取消就成为可约的了
        - **非周期性**
            - 在所有 \(p_{ii}^{(n)}>0\) 的 \(n\) 中没有比 1 大的公因子

### 状态图
- 状态转移图/马尔科夫状态图/香农线图
- 元素
    - 状态$S_i$ 
    - 箭头：转移
    - 箭头旁标数字：转移概率